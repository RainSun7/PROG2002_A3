<!DOCTYPE html>

<head>
    <title>Help Each Other</title>
</head>

<body>


    <!-- Header section displaying the main title and introduction -->
    <header>
        <h1>Support Our Fundraising Effirts and Make a Difference!</h1>
        <!-- Navigation bar with links to different sections of the website -->
        <nav>
            <a href="Admin.html">Admin</a>
        </nav>
    </header>

    <div id="data2"></div>

    <form id="updateForm" onsubmit="updateFundraiser(); return false;">
        <label>Fundraiser ID</label>
        <input type="text" id="updateFUNDRAISER_ID" placeholder="Enter Fundraiser ID" required><br>

        <label>Organizer</label>
        <input type="text" id="updateORGANIZER" placeholder="Enter Organizer" required><br>

        <label>Caption</label>
        <input type="text" id="updateCAPTION" placeholder="Enter Caption" required><br>

        <label>Target Funding</label>
        <input type="text" id="updateTARGET_FUNDING" placeholder="Enter Target Funding" required><br>

        <label>Current Funding</label>
        <input type="text" id="updateCURRENT_FUNDING" placeholder="Enter Current Funding" required><br>

        <label>City</label>
        <input type="text" id="updateCITY" placeholder="Enter City" required><br>

        <label>Active</label>
        <input type="text" id="updateACTIVE" placeholder="Enter Active (1 or 0)" required><br>

        <label>CATEGORY ID</label>
        <input type="text" id="updateCATEGORY_ID" placeholder="Enter Category ID" required><br>

        <input type="submit" value="Update">
    </form>
    <!-- Footer section -->
    <footer>Thank you for your kindness and generosity! Together, we can bring hope and make a lasting difference for
        the future.</footer>
</body>

<style>
    /* General body styles */
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 20px;
        background-color: #f9f9f9;
    }

    /* Header section styles */
    header {
        background-color: #31c8c8;
        color: white;
        padding: 5px 0;
        text-align: center;
        border-radius: 0 0 20px 20px;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        z-index: 1000;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
   
    }

    header h1 {
        font-size: 1.5rem;
        margin: 0;
    }

    header p {
        line-height: 1.2;
        margin: 0;
    }

    /* h1 element styles */
    h1 {
        background-color: #31c8c8;
        color: white;
        padding: 10px;
        text-align: center;
        border-radius: 5px;
    }

    /* Navigation bar styles */
    nav {
        margin-top: 10px;
        /* Space between header and nav */
    }

    nav a {
        margin: 0 15px;
        /* Space between links */
        text-decoration: none;
        color: white;
        /* White text color for nav links */
        font-weight: bold;
        /* Bold font for emphasis */
        transition: color 0.3s;
        /* Smooth transition for hover effect */
    }

    nav a:hover {
        color: #ffeb3b;
        /* Highlight color on hover */
    }

    #data {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 10px;
        right: 10%;
    }

    #data2 {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-top: 10px;
    }

    .box {
        display: flex;
        background: white;
        padding: 50px;
        width: 60%;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        box-sizing: border-box;
        margin: 50px auto;
        text-align: left;
        justify-content: center;
        align-items: center;
        position: absolute;
        top: 200px;
        left: 3%;

    }

    .box img {
        max-width: 500px;
        border-radius: 5px;
        margin-left: 15px;
    }

    .box2 {
        display: flex;
        background: white;
        padding: 50px;
        width: 60%;
        border-radius: 5px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        box-sizing: border-box;
        margin: 50px auto;
        text-align: left;
        justify-content: center;
        align-items: center;
        position: absolute;
        top: 200px;
        right: 3%;

    }

    #updateForm {
        background: white;
        padding: 30px;
        width: 350px;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        margin: auto;
        text-align: center;
        position: absolute;
        top: 220px;
        left: 3%;
    }

    input[type="text"] {
        width: calc(100% - 20px);
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #ccc;
        border-radius: 5px;
        box-sizing: border-box;
        transition: border-color 0.3s;
    }

    input[type="text"]:focus {
        border-color: #4a90e2;
        outline: none;
    }

    input[type="submit"] {
        background-color: #4a90e2;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
        font-weight: bold;
    }

    input[type="submit"]:hover {
        background-color: #357ab8;
    }

    /* Footer styles */
    footer {
        position: fixed;
        background-color: #31c8c8;
        bottom: 0;
        color: white;
        padding: 10px;
        text-align: center;
        border-radius: 5px;
        width: 100%;
    }
</style>

</html>

<script>
    // Create a URLSearchParams object to extract query parameters from the URL
    const params = new URLSearchParams(window.location.search);
    // Extract the 'id' parameter from the URL
    const id = params.get('id');

    // Fetch donation data associated with the fundraiser ID from the server
    fetch(`http://localhost:3060/ShowDonation/${id}`)
        .then(response => response.json()) // Parse the response as JSON
        .then(data => {
            const dataDiv = document.getElementById('data2'); // Get the data div to insert content
            dataDiv.innerHTML = ""; // Clear any existing content in the div
            // If there is donation data, fill the data into the box
            if (data.length > 0) {
                data.forEach(donation => {
                    const boxDiv = document.createElement("div");
                    boxDiv.classList.add("box2");
                    boxDiv.innerHTML = `
                        <p>DONATION ID: ${donation.DONATION_ID}</p>
                        <p>FUNDRAISER ID: ${donation.FUNDRAISER_ID}</p>
                        <p>DATE: ${donation.DATE}</p>
                        <p>AMOUNT: ${donation.AMOUNT} AUD</p>
                        <p>GIVER: ${donation.GIVER}</p>
                    `;

                    dataDiv.appendChild(boxDiv); // Append the created div to the data div
                });
            }
        })
        // Error handling
        .catch(error => {
            console.error("Error fetching data", error);
            document.getElementById('data').textContent = "Failed to load data";
        });

    // Function to update a fundraiser's details by sending a PUT request to the server
    function updateFundraiser() {
        const FUNDRAISER_ID = document.getElementById('updateFUNDRAISER_ID').value.trim();
        const ORGANIZER = document.getElementById('updateORGANIZER').value.trim();
        const CAPTION = document.getElementById('updateCAPTION').value.trim();
        const TARGET_FUNDING = document.getElementById('updateTARGET_FUNDING').value.trim();
        const CURRENT_FUNDING = document.getElementById('updateCURRENT_FUNDING').value.trim();
        const CITY = document.getElementById('updateCITY').value.trim();
        const ACTIVE = document.getElementById('updateACTIVE').value.trim();
        const CATEGORY_ID = document.getElementById('updateCATEGORY_ID').value.trim();

        if (!FUNDRAISER_ID || !ORGANIZER || !CAPTION || !TARGET_FUNDING || !CURRENT_FUNDING || !CITY || !ACTIVE || !CATEGORY_ID) {
            alert("All fields are required!");
            return;
        }

        const postData = { 'FUNDRAISER_ID': FUNDRAISER_ID, 'ORGANIZER': ORGANIZER, 'CAPTION': CAPTION, 'TARGET_FUNDING': TARGET_FUNDING, 'CURRENT_FUNDING': CURRENT_FUNDING, 'CITY': CITY, 'ACTIVE': ACTIVE, 'CATEGORY_ID': CATEGORY_ID };

        // Send a PUT request to update the fundraiser with the specified ID
        fetch(`http://localhost:3060/updateFundraise/${FUNDRAISER_ID}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(postData)
        })
            .then(response => response.json())
            .then(data => {
                if (data.update === 'success') {
                    alert(`Fundraiser with ID ${FUNDRAISER_ID} updated successfully!`);
                    document.getElementById('updateForm').reset();
                } else {
                    alert("Error updating fundraiser.");
                }
            })
            .catch(error => {
                console.error("Error:", error);
            });
    }
</script>